<!doctype html public "-//w3c//dtd html	4.0	transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.6 [en]	(Win98;	I) [Netscape]">
   <title>System Calls Reference</title>
</head>
<body>
<table BORDER=0	CELLSPACING=0 CELLPADDING=0	WIDTH="100%" >
<tr>
<th	ALIGN=CENTER COLSPAN="3">Z88 Developers' Notes</th>
</tr>
<tr>
<td	ALIGN=LEFT VALIGN=BOTTOM WIDTH="10%"><a	href="index.html">Contents</a></td>
<td	ALIGN=CENTER VALIGN=BOTTOM WIDTH="80%">&nbsp;</td>
<td	ALIGN=RIGHT	VALIGN=BOTTOM WIDTH="10%"><a href="sysref.html">Contents&nbsp;of&nbsp;System&nbsp;Calls</a></td>
</tr>
</table>

<hr	WIDTH="100%">
<p>

<b><font size=+1>OS_Map, PipeDream map control</font></b>
<p><tt>RST 20H,	DEFW $F406</tt>
<p>IN:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; BC = reason code
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MP_WR ($01)&nbsp;&nbsp;&nbsp; write a line to the map
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MP_DEF ($02)&nbsp;&nbsp;	define a map using the Panel default width
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MP_GRA ($03)&nbsp;&nbsp;	define a map of	specific width
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MP_DEL ($04)&nbsp;&nbsp;	delete a map</pre>
OUT, if	call successful:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; Fc = 0</pre>
OUT, if	call failed:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; Fc = 1
&nbsp;&nbsp;&nbsp;&nbsp; A = error code:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RC_BAD ($04), bad parameters	(errors	are	generally ignored)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RC_UNK ($03), value of BC is	not	valid</pre>
Registers changed after	return:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; defined by MP_ reason	code.
</pre>
<b>MP_WR ($01),	write a	line to	the	map</b>
<p>IN:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; A	= window ID	number (ASCII digit	'1'	to '6')
&nbsp;&nbsp;&nbsp;&nbsp; DE	= row of the map to	be written (0 to 63, 0 = top of	screen)
&nbsp;&nbsp;&nbsp;&nbsp; HL	= points to	bytes to be	written</pre>
OUT:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; -
</pre>
Registers changed after	return:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; ..BCDEHL/IXIY	same
&nbsp;&nbsp;&nbsp;&nbsp; AF....../.... different
</pre>
Notes:
<blockquote>HL points to a series of bytes,	where each byte	represents
8 pixels on	the	map. Bit 7 is the left most	pixel and the bytes	are	written
onto the map from left to right. The number	of bytes read from HL depends
on the width of	the	map.<br>
<br>
<BR></blockquote>
<b>MP_DEF ($02), define	a map using	the	Panel width</b>
<p>IN:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; A	= window ID	number (ASCII digit	'1'	to '6')</pre>
OUT:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; B	= width	of map in pixels
&nbsp;&nbsp;&nbsp;&nbsp; C = width of map in 6 bit characters</pre>
Registers changed after	return:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; A...DEHL/IXIY	same
&nbsp;&nbsp;&nbsp;&nbsp; .FBC..../.... different
</pre>
Notes:
<blockquote>This call simply reads the value of	the	map	size entry in the
Panel and attempts to define a map of that width.<br>
<br>
<BR></blockquote>
<b>MP_GRA ($03), define	a map of specific width</b>
<p>IN:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; A	= window ID	number (ASCII digit	'1'	to '6')
&nbsp;&nbsp;&nbsp;&nbsp; HL	= width	of map to set up (0	to 255)</pre>
OUT:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; as for MP_DEF
</pre>
<b>MP_DEL ($04), delete	a map</b>
<p>IN:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; A	= window ID	number (ASCII digit	'1'	to '6')</pre>
OUT:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; -</pre>
Notes:
<blockquote>At present there is	only one map area and it is	reclaimed for
text by	redefining the window in which it sits,	or by defining a window
which overlaps it. However,	to allow for future	expansion this call	should
be used	if a map area is to	be reclaimed for text use.<br>
<BR></blockquote>

</body>
</html>
